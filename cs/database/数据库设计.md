### 简介
数据库设计就是根据业务系统的需要，结合选择的DBMS,设计最优的数据存储模型。同时建立好表的结构，以及表与表的关联关系。
最后达成的效果是：有效的储存数据，并且可以高效的从数据库中取出已存储的数据。

设计过程: 需求分析 -> 逻辑设计 -> 物理设计 -> 维护优化

### 需求分析
1. 了解系统中所要存储的数据, 数据是什么
2. 了解数据的存储特点, 数据有哪些属性
3. 了解数据的生命周期, 数据和属性各自的特点

对实体的分析:
实体与实体之间的关系(一对一, 一对多, 多对多)
实体有哪些属性
哪些属性或与属性组合能唯一标识实体的

### 逻辑设计
实现方式: ER建模, UML图形化展示(PowerDesigner, Navicat)

操作异常: 
+ 插入异常: 插入一个实体必须输入其他实体
+ 更新异常: 修改一个实体需要修改其他实体
+ 删除异常: 删除一个实体必须删除其他实体

数据冗余:
+ 同样的数据多个地方存在
+ 能通过一定的计算就能获取的数据

规范化设计能够有效的避免数据冗余导致的更新异常，它基于范式思想。一个关系是否满足某种范式通常要看它是否不包含某个函数依赖。
**第一范式(1NF)**
一个表如果每一行都是唯一，并且任何行都没有包含多个值的列，则它满足1NF
**第二范式(2NF)**
表中不存在非关键字段对任一候选关键字段的部分函数依赖。如果两个或两个以上信息组合的字段称为组合关键字段。非关键字段对组合关键字段存在依赖关系就叫做部分函数依赖。单关键字段的表都是符合第二范式的
**第三范式(3NF)**
如果表中不存在非关键字段对任意候选关键字段的传递函数依赖则符合第三范式
**BC范式(BCNF)**
数据库表中如果不存在任何字段对任一候选关键字段的传递函数依赖则附合BC范式; 也就是说如果是复合关键字，则复合关键字之间也不能存在函数依赖关系；

总结：
1NF： 字段是最小的的单元不可再分 
2NF：满足1NF,表中的字段必须完全依赖于全部主键而非部分主键 (一般我们都会做到)
3NF：满足2NF,非主键外的所有字段必须互不依赖
4NF：满足3NF,消除表中的多值依赖

***解决方法: 拆分表***

### 物理设计
1. 选择数据库系统: 应用特点, 成本
2. 定义库, 表, 字段的命名规范(数据库系统对此有限制)
3. 根据系统选择合适的字段类型
4. 反范式化设计: 增加冗余, 提高效率

*备注：关于反范式设计: 主要是提高查询速度, 以空间换取时间的一种方式*

**字段类型的选择原则**
+ 在对数据进行比较(查询条件,JOIN条件及排序)操作时: 数字>日期>字符串; 空间小的>空间大的. 
+ 在数据库中，数据处理以页为单位，列的长度越小，利于性能提升。

**char 与 varchar 如何选择**
如果列中要存储的数据长度差不多是一致的，则应该考虑用char，反之使用varchar。如果列中的最大数据长度小于50byte(utf-8格式中大概13个字符)，则一般也考虑用char。(如果这个 列很少用，内里基于节省空间和减少I/O的考虑，还是可以选择用varchar), 一般不宜定义大于50Byte的char类型列.  ***由于char是以固定长度的，所以它的速度会比varchar快得多!但程序处理起来要麻烦一点，要用trim之类的函数把两边的空格去掉!(nvarchar: var代表不定长, n开头代表是unicode编码)***

**decimal 与 float 如何选择**
decimal用于存储精确数据，而float只能用于存储非精确数据。故精确数据只能选择用decimal类型。由于float的存储空间开销一般比decimal小（精确到7位小数只需要4个字节，而精确到15位小数只需要8个字节），故非精确数据优先选择float类型。

**注意事项**
1. 区分业务主键和数据库主键, 考虑是否逻辑增长, 占用空间尽量小
2. 避免使用外键约束, 但是关联列需要建立索引
3. 避免使用触发器
4. 严禁使用预留字段

### 维护优化
1. 数据字典记录表中每个列所存储的内容是什么，方便后期维护和升级，特别是一些状态字段
2. 索引的维护，主要是从一个动态变化的角度来看待我们的数据和索引
3. 维护表结构
4. 当表中的数据量达到一个数量级的话，可能会影响查询的速度，此时就需要对表进行适当


**参考文献**:
- [MicroSoft 数据库设计基础](https://support.office.com/zh-cn/article/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E5%9F%BA%E7%A1%80-eb2159cf-1e30-401a-8084-bd4f9c9ca1f5)
